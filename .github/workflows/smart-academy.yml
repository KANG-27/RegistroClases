name: Agendar clase Smart Academy

on:
  workflow_dispatch:
    inputs:
      dry_run:
        description: "No reservar; solo navegar (sin screenshots)"
        type: boolean
        default: true
  schedule:
    - cron: '5 12 * * 1-6' # 07:05 Bogot√°

jobs:
  run:
    runs-on: ubuntu-latest
    env:
      TZ: America/Bogota
      SMART_USER: ${{ secrets.SMART_USER }}
      SMART_PASS: ${{ secrets.SMART_PASS }}
      DRY_RUN: ${{ inputs.dry_run }}
      DEBUG: puppeteer:*   # logs detallados en consola
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - name: Check env present
        run: node -e "if(!process.env.SMART_USER||!process.env.SMART_PASS){throw new Error('Missing env vars')}"
      - run: npm ci
      - name: Run script
        run: node scripts/smart-academy.js
